## Label Smoothing

<img width="542" alt="스크린샷 2024-08-31 224842" src="https://github.com/user-attachments/assets/513eb12e-cb2c-463b-974d-ec438e42c5bf">

| Label Smoothing | Augmentation | TEST |||||  TRAIN |||||
|-----------------|--------------|------|------|------|------|------|------|------|------|------|------|
|                 |              | Accuracy | F1 | CEE | ECE | Accuracy | F1 | CEE | ECE |
| 0.05 | Hflip(0.5) | 0.6411 | 0.6485 | 1.0603 | 0.0730 | 0.6917 | 0.6893 | 0.9434 | 0.0430 |
| 0.1  | Hflip(0.5) | 0.6544 | 0.6577 | 1.0659 | | 0.6889 | 0.6894 | 0.9761 | 0.0371 |
| 0.15 | Hflip(0.5) | 0.6622 | 0.6698 | 1.0077 | | 0.6708 | 0.6706 | 0.9758 | 0.0400 |
| 0.2  | Hflip(0.5) | 0.6267 | 0.6313 | 1.0953 | 0.0790 | 0.6722 | 0.6712 | 1.0318 | 0.1083 |
| 0.25 | Hflip(0.5) | 0.6411 | 0.6483 | 1.1132 | | 0.6708 | 0.6739 | 1.0212 | 0.1058 |
| 0.3  | Hflip(0.5) | 0.6400 | 0.6443 | 1.1368 | | 0.6764 | 0.6762 | 1.0780 | 0.1552 |
| 0.35 | Hflip(0.5) | 0.6467 | 0.6540 | 1.1601 | | 0.6861 | 0.6861 | 1.0938 | 0.1876 |
| 0.4  | Hflip(0.5) | 0.6444 | 0.6503 | 1.1944 | | 0.7125 | 0.7130 | 1.1114 | 0.2363 |
| 0.45 | Hflip(0.5) | 0.6411 | 0.6469 | 1.2463 | 0.2121 | 0.6889 | 0.6902 | 1.1799 | 0.2511 |
| 0.5  | Hflip(0.5) | 0.6389 | 0.6476 | 1.2879 | 0.2427 | 0.6750 | 0.6774 | 1.2372 | 0.2657 |


# Label Smoothing 및 데이터 증강 분석

## 주요 관찰 사항

1. **Label Smoothing**: 
   - 값의 범위: 0.05에서 0.5까지 변화

2. **데이터 증강**: 
   - 모든 실험에서 Hflip(0.5) 사용 (50% 확률로 이미지를 수평으로 뒤집는 기법)

3. **정확도(Accuracy)와 F1 점수**:
   - TEST 데이터셋: Label Smoothing 0.15에서 최고 성능 (Accuracy: 0.6622, F1: 0.6698)
   - TRAIN 데이터셋: Label Smoothing 0.4에서 최고 성능 (Accuracy: 0.7125, F1: 0.7130)

4. **Cross-Entropy Error (CEE)**:
   - TEST 데이터셋: Label Smoothing 증가에 따라 CEE도 대체로 증가
   - TRAIN 데이터셋: 비슷한 경향이나 변동 존재

5. **Expected Calibration Error (ECE)**:
   - 제한된 데이터지만, Label Smoothing 증가에 따라 ECE도 증가하는 경향

6. **과적합(Overfitting) 징후**:
   - 낮은 Label Smoothing: TRAIN 성능이 TEST보다 훨씬 높음
   - Label Smoothing 증가: 이 차이가 점차 감소

## 최적값 선택 분석

### 고려사항

1. **TEST 데이터셋 성능**:
   - Accuracy/F1: 0.15에서 최고 (Accuracy: 0.6622, F1: 0.6698)
   - CEE: 0.15에서 최저 (1.0077)
   - ECE: 낮은 값에서 더 좋은 성능

2. **TRAIN 데이터셋 성능**:
   - Accuracy/F1: 0.05-0.1 사이에서 좋은 성능
   - CEE: 0.05에서 최저 (0.9434)
   - ECE: 0.1에서 최저 (0.0371)

3. **과적합 고려**:
   - 0.15-0.2 부근에서 TRAIN과 TEST 성능 격차 감소

4. **모델의 일반화 능력**:
   - 너무 낮은 값: 과적합 위험
   - 너무 높은 값: 성능 저하 위험

### 주요 후보 분석

1. **Label Smoothing 0.15**:
   - TEST 데이터셋 최고 Accuracy/F1 및 최저 CEE
   - 적절한 TRAIN/TEST 성능 차이로 과적합 위험 낮음

2. **Label Smoothing 0.1**:
   - TEST 성능 0.15에 근접
   - TRAIN ECE 최저, TRAIN Accuracy/F1 높음

3. **Label Smoothing 0.05**:
   - TRAIN 데이터 좋은 성능
   - TEST와 격차 커서 과적합 우려

## 결론 및 추천

- **추천값**: Label Smoothing 0.15
  1. TEST 데이터셋 성능 최우수
  2. 과적합 위험 낮음
  3. 낮은 CEE로 모델의 불확실성 추정 개선

- **대안**: Label Smoothing 0.1
  - TRAIN ECE가 낮아 모델 보정이 중요한 경우 고려

- **최종 선택 기준**:
  - 모델의 사용 목적과 환경에 따라 결정
  - 일반화 능력 중시: 0.15 선택
  - 훈련 데이터 성능/보정 중시: 0.1 선택
