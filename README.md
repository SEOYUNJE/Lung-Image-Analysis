# Lung-Image-Analysis
ðŸ“Œ **Chest X-Ray Lung Disease Classification with Grad-CAM Localization**

=> This task involves `classifying lung diseases` using chest X-ray images and highlighting the affected regions using `Grad-CAM` (Gradient-weighted Class Activation Mapping).

## Overview
The detection and classification of diseases from Chest X-ray (CXR) images is a crucial task in medical diagnostics, enabling timely and accurate identification of various thoracic conditions. This project aims to leverage advanced machine learning and deep learning techniques to detect and classify distinct diseases from CXR images.

## View Position
![image](https://github.com/user-attachments/assets/c435fd1c-350e-4b27-94a9-61557a07baae)



## Data Description
### ðŸ“Œ NIH Dataset

> **Original Data**

  => [NIH Chest X-rays](https://www.kaggle.com/datasets/nih-chest-xrays/data)
   #### Citations
     - Wang X, Peng Y, Lu L, Lu Z, Bagheri M, Summers RM. ChestX-ray8: Hospital-scale Chest X-ray Database and Benchmarks on Weakly-Supervised Classification and - -Localization of Common Thorax Diseases. IEEE CVPR 2017, ChestX-ray8_Hospital-Scale_Chest_CVPR_2017_paper.pdf

     - NIH News release: NIH Clinical Center provides one of the largest publicly available chest x-ray datasets to scientific community
  
     - Original source files and documents: https://nihcc.app.box.com/v/ChestXray-NIHCC/folder/36938765345


> **Custom Data**

  => [NIH Big Dataset](https://www.kaggle.com/datasets/seoyunje/nih-big-dataset)
  
   #### Modifications to original data 
   - We just only select No Finding, Edema, Atelectasis, Pneumonia, Effusion, Pneumothorax, Emphysema, Consolidation, Fibrosis 

   - To address the issue of data imbalance, We selected only 10,000 cases of "No Finding."
   
   - In the given NIH dataset, the labels generated by the RNN sometimes incorrectly indicate diseases. Therefore, if a patient has multiple diseases, any instance labeled as "No Finding" is removed in such cases.

   - Due to the differences in lung structure between children and adults, images of adolescents under the age of 16 were not included
   #### Introduce of custom data 
   
   - There are only `10` Diseases in custom datasets
   
   - There are `29,884` images(format: png, 1024x1024) in custom datasets
   
   - There are `11,016` AP View in custom datasets
   
   - There are `18,868` PA View in custom datasets
   
   - There are `14,939` Patient IDs in custom datasets

        | Finding Labels       | Count |
        |----------------------|-------|
        | No Finding           | 9526   |
        | Edema                | 1131   |
        | Atelectasis          | 7028   |
        | Pneumonia            | 690   |
        | Effusion             | 7320   |
        | Pneumothorax         | 3501   |
        | Emphysema            | 1667   |
        | Consolidation        | 2543   |
        | Fibrosis             | 1022   |
        | Cardiomegaly         | 1904   |

### ðŸ“Œ PC Dataset

> **Original Data**

  => [PadChest Dataset](https://academictorrents.com/details/96ebb4f92b85929eadfb16761f310a6d04105797)
   #### License
     Creative Commons Attribution-ShareAlike 4.0 International License

> **Custom Data**

  => [PC Dataset](https://www.kaggle.com/datasets/seoyunje/pc-dataset)
  
   #### Modifications to original data 
   - We just only select No Finding, Edema, Atelectasis, Pneumonia, Effusion, Pneumothorax, Emphysema, Consolidation, Fibrosis 

   - To address the issue of data imbalance, We selected only 10,000 cases of "No Finding."
   
   - In the given NIH dataset, the labels generated by the RNN sometimes incorrectly indicate diseases. Therefore, if a patient has multiple diseases, any instance labeled as "No Finding" is removed in such cases.

   - Due to the differences in lung structure between children and adults, images of adolescents under the age of 16 were not included
   #### Introduce of custom data 
   
   - There are only `10` Diseases in custom datasets
   
   - There are `29,835` images(format: png, 224x224) in custom datasets
   
   - There are `1711` AP View in custom datasets
   
   - There are `28,124` PA View in custom datasets
   
   - There are `23,305` Patient IDs in custom datasets

        | Finding Labels       | Count |
        |----------------------|-------|
        | No Finding           | 9925   |
        | Edema                | 458   |
        | Atelectasis          | 4420   |
        | Pneumonia            | 3625   |
        | Effusion             | 4165   |
        | Pneumothorax         | 249   |
        | Emphysema            | 962   |
        | Consolidation        | 1032   |
        | Fibrosis             | 683   |
        | Cardiomegaly         | 8722   |

![image](https://github.com/user-attachments/assets/61482c15-7aaf-4707-aa68-ededd53d018f)


## The hierarchical relationships between lung diseases


=> The image below is a diagram of hierarchical medical data.

![hier](https://github.com/user-attachments/assets/e6d867c7-4b8c-4d25-87a1-fd6ef0153b14)

![image](https://github.com/user-attachments/assets/7da8910e-311a-49f6-b972-f0ec3bcf76f0)

![image](https://github.com/user-attachments/assets/852fe680-98e1-4c7f-af2d-960955512d5c)



## Data Preprocssing
![image](https://github.com/user-attachments/assets/74a35f27-d249-4587-aca6-023dec5ca3ef)

## Data Augmentation

![image](https://github.com/user-attachments/assets/db88dfaa-f803-4640-ba7e-bc8d8590ac38)

## Split Train/Test dataset
Separate sets of cases for training and testing algorithms are important for ensuring that all researchers are using the same cases for these tasks. Specifically, the test set should contain cases of varying difficulty in order to ensure that the method is tested thoroughly. The data were split into a training set and a testing set based on the Lung Diseases. 

There are `47775` images in train set. (80% of total)

There are `11944` images in test set. (20% of total)

![image](https://github.com/user-attachments/assets/02cad021-aca4-4653-9077-45db7a87f3ff)



## Hybrid Model

![image](https://github.com/user-attachments/assets/2a555cf5-107b-47ac-896c-0916f389240d)



## Hierarchical model
![image](https://github.com/user-attachments/assets/e0d5f679-8bd8-4ce2-bdde-0f034cf6b952)

